const TelegramBot = require('node-telegram-bot-api');
const express = require('express');

const app = express();
const PORT = process.env.PORT || 3000;

// –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è
const token = process.env.TELEGRAM_BOT_TOKEN;

// –°–æ–∑–¥–∞–π—Ç–µ —ç–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞
const bot = new TelegramBot(token, { polling: true });

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã /start
bot.onText(/\/start/, (msg) => {
    const chatId = msg.chat.id;
    bot.sendMessage(chatId, '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏–≥—Ä—É! –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –º–æ–Ω–µ—Ç–∫—É, —á—Ç–æ–±—ã –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å –±–∞–ª–ª—ã!', {
        reply_markup: {
            keyboard: [[{ text: 'üí∞ –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –º–æ–Ω–µ—Ç–∫—É' }]],
            resize_keyboard: true,
            one_time_keyboard: true,
        },
    });
});

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –Ω–∞ –º–æ–Ω–µ—Ç–∫—É
bot.onText(/üí∞ –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –º–æ–Ω–µ—Ç–∫—É/, (msg) => {
    const chatId = msg.chat.id;
    // –ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –¥–ª—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –±–∞–ª–ª–æ–≤
    // –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–∏ –±–∞–ª–ª–æ–≤
    bot.sendMessage(chatId, '–í—ã –∑–∞—Ä–∞–±–æ—Ç–∞–ª–∏ 1 –±–∞–ª–ª!');
});

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã /leaderboard –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç—É—Ä–Ω–∏—Ä–∞
bot.onText(/\/leaderboard/, (msg) => {
    const chatId = msg.chat.id;
    // –ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Ç—É—Ä–Ω–∏—Ä–∞
    bot.sendMessage(chatId, '–¢–µ–∫—É—â–∏–π –ª–∏–¥–µ—Ä–±–æ—Ä–¥: –µ—â–µ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ.');
});

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã /upgrade –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–ª–∏–∫–∞
bot.onText(/\/upgrade/, (msg) => {
    const chatId = msg.chat.id;
    // –ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–ª–∏–∫–∞
    bot.sendMessage(chatId, '–í—ã —É–ª—É—á—à–∏–ª–∏ —Å–≤–æ–π –∫–ª–∏–∫! –¢–µ–ø–µ—Ä—å –≤—ã –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç–µ 2 –±–∞–ª–ª–∞ –∑–∞ –∫–ª–∏–∫!');
});

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∞ –¥–ª—è Express
app.get('/', (req, res) => {
    res.send('–ò–≥—Ä–∞ –∫–ª–∏–∫–µ—Ä –∑–∞–ø—É—â–µ–Ω–∞!');
});

// –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
app.listen(PORT, () => {
    console.log(`–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É ${PORT}`);
});
